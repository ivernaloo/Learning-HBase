HBase successfully connected，table list：  ['_canary_', 'b2c_boss:balance_change', 'b2c_boss:cdr', 'b2c_boss:rate_cdr', 'b2c_dc:config_table', 'b2c_dc:streaming_uv', 'b2c_dc:test_device', 'b2c_dc:test_device1', 'b2c_dc:user_log', 'b2c_kf:chat_message', 'b2c_kf:chat_record', 'b2c_kf:session_record', 'b2c_kf:word_trend', 'b2c_misite:antispam_collect_ip', 'b2c_misite:antispam_collect_user', 'b2c_misite:bp_collect', 'b2c_misite:bp_collect_ip', 'b2c_misite:bp_collect_uid', 'b2c_misite:contest_profile', 'b2c_misite:sts_daily', 'b2c_misite:sts_online', 'cashpay:pay-device', 'cashpay:rms-device', 'cashpay:rms-event', 'cashpay:rms-history', 'cashpay:rms-relation', 'cashpay:rms-user', 'cube:cube_event_app', 'cube:cube_event_book', 'cube:cube_event_duokan', 'cube:cube_event_inlinevideo', 'cube:cube_event_mishop', 'cube:cube_event_music', 'cube:cube_event_musicrec', 'cube:cube_event_news', 'cube:cube_event_picture', 'cube:cube_event_pub', 'cube:cube_event_svideo', 'cube:cube_event_theme', 'cube:cube_event_video', 'cube:cube_result', 'cube:cubedb_r_app', 'cube:cubedb_r_book', 'cube:cubedb_r_browser', 'cube:cubedb_r_common', 'cube:cubedb_r_duokan', 'cube:cubedb_r_example', 'cube:cubedb_r_inlinevideo', 'cube:cubedb_r_mishop', 'cube:cubedb_r_music', 'cube:cubedb_r_musicrec', 'cube:cubedb_r_news', 'cube:cubedb_r_picture', 'cube:cubedb_r_pub', 'cube:cubedb_r_svideo', 'cube:cubedb_r_theme', 'cube:cubedb_r_video', 'gamesdk:ext_hour', 'gamesdk:huyu_user_trail', 'gamesdk:imeiMD5-hour-action', 'gamesdk:user_imei_trail', 'h_xmunion:b2c_activate_data', 'hive:test', 'hive_test', 'huyu_live_data:client_cmd', 'huyu_liverecommend:focus_history', 'huyu_liverecommend:live_history', 'huyu_liverecommend:view_history', 'mifi_anti_fraud:mifi_imei_collection', 'mifi_anti_fraud:mifi_uid_collection', 'mifi_business:mifi_credit', 'mistats:basic', 'mistats:network', 'mistats:xiaomi-stats', 'mistats:xiaomi-stats-ua', 'miui_appstore:as_user_info', 'miui_appstore:kylin_metadata', 'miui_appstore:kylin_metadata_acl', 'miui_appstore:kylin_metadata_user', 'miui_appstore:xiaomiid_imei_info', 'miui_backcall:user_call', 'miui_metok:imei_areas', 'miui_mipay_fees:meta-table', 'miui_mipay_fees:tree-table', 'miui_mipay_fees:tsdb-table', 'miui_mipay_fees:tsdb-uid', 'miui_sec:common_result', 'miui_sec:data', 'miui_sec:flow_order_bill', 'miui_sec:flow_order_order', 'miui_sec:flow_order_order_ack', 'miui_sec:flow_order_order_pay', 'miui_sec:flow_order_order_provider', 'miui_sec:mqsas_exp_report', 'miui_sec:mqsas_report', 'miui_sec:stat', 'miui_vip:activity', 'miui_vip:award_history', 'miui_vip:backup_activity', 'miui_vip:badge_activity', 'miui_vip:daily_game_activity', 'miui_vip:game_activity', 'miui_vip:game_status', 'miui_vip:manual_ops', 'miui_vip:olympic_money', 'miui_vip:pisces', 'miui_vip:pisces_history', 'miui_vip:rank_activity', 'miui_vip:status', 'miui_vip:target_history', 'miui_vip:task_activeid', 'miui_vip:task_history', 'miui_vip:transaction', 'miui_vip:user_award', 'miui_vip:user_buff', 'miui_vip:user_log', 'miui_vip:user_special', 'miui_vip:user_statistics', 'miui_vip:user_target_recommend', 'miui_vip:user_task', 'passport:passport_action', 'passport:passport_antispam_stat', 'passport:passport_support_log', 'passport:passport_track_event', 'profile:cloud_dataplatform_joke', 'profile:cloud_dataplatform_news_cn', 'profile:cloud_dataplatform_news_dedup_cn', 'profile:cloud_dataplatform_news_i18n', 'profile:cloud_dataplatform_picture', 'profile:cloud_dataplatform_recommend_feature', 'profile:cloud_dataplatform_sogou_baike', 'profile:cloud_dataplatform_sogou_wenwen', 'profile:cloud_dataplatform_video_cn', 'profile:cloud_dataplatform_weibo', 'profile:cloud_dataplatform_weibo_topic', 'profile:cloud_dataplatform_weibo_weibo', 'profile:cloud_dataplatform_zhihu', 'profile:cloud_dataplatform_zixun', 'profile:cloud_dataplatform_zixun_ductr', 'profile:cloud_dataplatform_zixun_uctr', 'profile:cloud_dp_id_mapping', 'profile:cloud_dp_ip_access_stats', 'profile:heliangtest_hbase98', 'profile:mapping_graph_edge', 'profile:mapping_graph_vertex', 'profile:recommend_user_actions', 'profile:recommend_user_history_staging', 'profile:user_profile', 'profile:weibo_user_info', 'profile:weibo_user_info_test', 'profile:xiaomi_device_event', 'profile:xiaomi_device_info', 'profile:xiaomi_device_info_test', 'profile:xiaomi_device_trace', 'profile:xiaomi_id_mapping', 'profile:xiaomi_ip_profile', 'profile:xiaomi_user_event', 'profile:xiaomi_user_olap', 'profile:xiaomi_user_olap_test', 'profile:xiaomi_user_profile', 'profile:xiaomi_user_profile_test', 'test_coprocessor', 'test_ns:test_autoflush_table', 'test_ns:test_autoflush_table_salted', 'test_table_truncate_salted']
MongoDB mongoDB successfully connected:    True
Traceback (most recent call last):
  File "crontabFailedAndGroup.py", line 21, in <module>
    time.sleep(1)
KeyboardInterrupt
HBase successfully connected，table list：  ['_canary_', 'b2c_boss:balance_change', 'b2c_boss:cdr', 'b2c_boss:rate_cdr', 'b2c_dc:config_table', 'b2c_dc:streaming_uv', 'b2c_dc:test_device', 'b2c_dc:test_device1', 'b2c_dc:user_log', 'b2c_kf:chat_message', 'b2c_kf:chat_record', 'b2c_kf:session_record', 'b2c_kf:word_trend', 'b2c_misite:antispam_collect_ip', 'b2c_misite:antispam_collect_user', 'b2c_misite:bp_collect', 'b2c_misite:bp_collect_ip', 'b2c_misite:bp_collect_uid', 'b2c_misite:contest_profile', 'b2c_misite:sts_daily', 'b2c_misite:sts_online', 'cashpay:pay-device', 'cashpay:rms-device', 'cashpay:rms-event', 'cashpay:rms-history', 'cashpay:rms-relation', 'cashpay:rms-user', 'cube:cube_event_app', 'cube:cube_event_book', 'cube:cube_event_duokan', 'cube:cube_event_inlinevideo', 'cube:cube_event_mishop', 'cube:cube_event_music', 'cube:cube_event_musicrec', 'cube:cube_event_news', 'cube:cube_event_picture', 'cube:cube_event_pub', 'cube:cube_event_svideo', 'cube:cube_event_theme', 'cube:cube_event_video', 'cube:cube_result', 'cube:cubedb_r_app', 'cube:cubedb_r_book', 'cube:cubedb_r_browser', 'cube:cubedb_r_common', 'cube:cubedb_r_duokan', 'cube:cubedb_r_example', 'cube:cubedb_r_inlinevideo', 'cube:cubedb_r_mishop', 'cube:cubedb_r_music', 'cube:cubedb_r_musicrec', 'cube:cubedb_r_news', 'cube:cubedb_r_picture', 'cube:cubedb_r_pub', 'cube:cubedb_r_svideo', 'cube:cubedb_r_theme', 'cube:cubedb_r_video', 'gamesdk:ext_hour', 'gamesdk:huyu_user_trail', 'gamesdk:imeiMD5-hour-action', 'gamesdk:user_imei_trail', 'h_xmunion:b2c_activate_data', 'hive:test', 'hive_test', 'huyu_live_data:client_cmd', 'huyu_liverecommend:focus_history', 'huyu_liverecommend:live_history', 'huyu_liverecommend:view_history', 'mifi_anti_fraud:mifi_imei_collection', 'mifi_anti_fraud:mifi_uid_collection', 'mifi_business:mifi_credit', 'mistats:basic', 'mistats:network', 'mistats:xiaomi-stats', 'mistats:xiaomi-stats-ua', 'miui_appstore:as_user_info', 'miui_appstore:kylin_metadata', 'miui_appstore:kylin_metadata_acl', 'miui_appstore:kylin_metadata_user', 'miui_appstore:xiaomiid_imei_info', 'miui_backcall:user_call', 'miui_metok:imei_areas', 'miui_mipay_fees:meta-table', 'miui_mipay_fees:tree-table', 'miui_mipay_fees:tsdb-table', 'miui_mipay_fees:tsdb-uid', 'miui_sec:common_result', 'miui_sec:data', 'miui_sec:flow_order_bill', 'miui_sec:flow_order_order', 'miui_sec:flow_order_order_ack', 'miui_sec:flow_order_order_pay', 'miui_sec:flow_order_order_provider', 'miui_sec:mqsas_exp_report', 'miui_sec:mqsas_report', 'miui_sec:stat', 'miui_vip:activity', 'miui_vip:award_history', 'miui_vip:backup_activity', 'miui_vip:badge_activity', 'miui_vip:daily_game_activity', 'miui_vip:game_activity', 'miui_vip:game_status', 'miui_vip:manual_ops', 'miui_vip:olympic_money', 'miui_vip:pisces', 'miui_vip:pisces_history', 'miui_vip:rank_activity', 'miui_vip:status', 'miui_vip:target_history', 'miui_vip:task_activeid', 'miui_vip:task_history', 'miui_vip:transaction', 'miui_vip:user_award', 'miui_vip:user_buff', 'miui_vip:user_log', 'miui_vip:user_special', 'miui_vip:user_statistics', 'miui_vip:user_target_recommend', 'miui_vip:user_task', 'passport:passport_action', 'passport:passport_antispam_stat', 'passport:passport_support_log', 'passport:passport_track_event', 'profile:cloud_dataplatform_joke', 'profile:cloud_dataplatform_news_cn', 'profile:cloud_dataplatform_news_dedup_cn', 'profile:cloud_dataplatform_news_i18n', 'profile:cloud_dataplatform_picture', 'profile:cloud_dataplatform_recommend_feature', 'profile:cloud_dataplatform_sogou_baike', 'profile:cloud_dataplatform_sogou_wenwen', 'profile:cloud_dataplatform_video_cn', 'profile:cloud_dataplatform_weibo', 'profile:cloud_dataplatform_weibo_topic', 'profile:cloud_dataplatform_weibo_weibo', 'profile:cloud_dataplatform_zhihu', 'profile:cloud_dataplatform_zixun', 'profile:cloud_dataplatform_zixun_ductr', 'profile:cloud_dataplatform_zixun_uctr', 'profile:cloud_dp_id_mapping', 'profile:cloud_dp_ip_access_stats', 'profile:heliangtest_hbase98', 'profile:mapping_graph_edge', 'profile:mapping_graph_vertex', 'profile:recommend_user_actions', 'profile:recommend_user_history_staging', 'profile:user_profile', 'profile:weibo_user_info', 'profile:weibo_user_info_test', 'profile:xiaomi_device_event', 'profile:xiaomi_device_info', 'profile:xiaomi_device_info_test', 'profile:xiaomi_device_trace', 'profile:xiaomi_id_mapping', 'profile:xiaomi_ip_profile', 'profile:xiaomi_user_event', 'profile:xiaomi_user_olap', 'profile:xiaomi_user_olap_test', 'profile:xiaomi_user_profile', 'profile:xiaomi_user_profile_test', 'test_coprocessor', 'test_ns:test_autoflush_table', 'test_ns:test_autoflush_table_salted', 'test_table_truncate_salted']
MongoDB mongoDB successfully connected:    True
Scaning data of 1 days ago,Date：2016-10-25
get 34893 total data from hbase
{'totalCount': 34893, 'succeed': 23519, 'totalFlow': 6226492}
get 11374 failed data from hbase
{'100036': {'total_num': 4, 'succ_num': 2}, '100030': {'total_num': 0, 'succ_num': 0}, '100031': {'total_num': 0, 'succ_num': 0}, '100033': {'total_num': 0, 'succ_num': 0}, '100032': {'total_num': 0, 'succ_num': 0}, '100016': {'total_num': 549, 'succ_num': 383}, '100017': {'total_num': 0, 'succ_num': 0}, '100014': {'total_num': 6501, 'succ_num': 4386}, '100015': {'total_num': 6, 'succ_num': 5}, '100012': {'total_num': 0, 'succ_num': 0}, '100013': {'total_num': 172, 'succ_num': 115}, '100010': {'total_num': 7, 'succ_num': 4}, '100011': {'total_num': 9391, 'succ_num': 6266}, '100038': {'total_num': 156, 'succ_num': 121}, '100034': {'total_num': 3, 'succ_num': 0}, '100018': {'total_num': 862, 'succ_num': 706}, '100019': {'total_num': 74, 'succ_num': 51}, '100029': {'total_num': 175, 'succ_num': 140}, '100037': {'total_num': 256, 'succ_num': 157}, '100028': {'total_num': 4, 'succ_num': 4}, '100039': {'total_num': 2, 'succ_num': 0}, '100035': {'total_num': 138, 'succ_num': 93}, '100023': {'total_num': 0, 'succ_num': 0}, '100022': {'total_num': 4, 'succ_num': 4}, '100005': {'total_num': 1, 'succ_num': 0}, '100004': {'total_num': 1, 'succ_num': 1}, '100007': {'total_num': 0, 'succ_num': 0}, '100006': {'total_num': 344, 'succ_num': 244}, '100001': {'total_num': 8290, 'succ_num': 5531}, '100000': {'total_num': 35, 'succ_num': 7}, '100003': {'total_num': 6097, 'succ_num': 4105}, '100002': {'total_num': 1692, 'succ_num': 1111}, '100027': {'total_num': 1, 'succ_num': 1}, '100026': {'total_num': 0, 'succ_num': 0}, '100025': {'total_num': 0, 'succ_num': 0}, '100024': {'total_num': 0, 'succ_num': 0}, '100009': {'total_num': 0, 'succ_num': 0}, '100008': {'total_num': 128, 'succ_num': 82}, '100021': {'total_num': 0, 'succ_num': 0}, '100020': {'total_num': 0, 'succ_num': 0}}
Failed order count in mongoDB:11373
2016-10-25
2016-10-25:data processed,add province and serviceProvider
2016-10-25
2016-10-25:data grouped,by province and serviceProvider
Scaning data of 1 days ago,Date：2016-10-26
get 35790 total data from hbase
{'totalCount': 35790, 'succeed': 25476, 'totalFlow': 6127592}
get 10314 failed data from hbase
{'100036': {'total_num': 1, 'succ_num': 1}, '100030': {'total_num': 0, 'succ_num': 0}, '100031': {'total_num': 0, 'succ_num': 0}, '100033': {'total_num': 0, 'succ_num': 0}, '100032': {'total_num': 0, 'succ_num': 0}, '100016': {'total_num': 622, 'succ_num': 453}, '100017': {'total_num': 0, 'succ_num': 0}, '100014': {'total_num': 6564, 'succ_num': 4683}, '100015': {'total_num': 2, 'succ_num': 1}, '100012': {'total_num': 2, 'succ_num': 2}, '100013': {'total_num': 167, 'succ_num': 121}, '100010': {'total_num': 12, 'succ_num': 11}, '100011': {'total_num': 9486, 'succ_num': 6629}, '100038': {'total_num': 234, 'succ_num': 194}, '100034': {'total_num': 6, 'succ_num': 1}, '100018': {'total_num': 845, 'succ_num': 784}, '100019': {'total_num': 9, 'succ_num': 4}, '100029': {'total_num': 181, 'succ_num': 152}, '100037': {'total_num': 273, 'succ_num': 179}, '100028': {'total_num': 5, 'succ_num': 4}, '100039': {'total_num': 2, 'succ_num': 1}, '100035': {'total_num': 144, 'succ_num': 101}, '100023': {'total_num': 0, 'succ_num': 0}, '100022': {'total_num': 5, 'succ_num': 4}, '100005': {'total_num': 3, 'succ_num': 2}, '100004': {'total_num': 0, 'succ_num': 0}, '100007': {'total_num': 0, 'succ_num': 0}, '100006': {'total_num': 352, 'succ_num': 253}, '100001': {'total_num': 8573, 'succ_num': 5983}, '100000': {'total_num': 27, 'succ_num': 18}, '100003': {'total_num': 6336, 'succ_num': 4587}, '100002': {'total_num': 1810, 'succ_num': 1230}, '100027': {'total_num': 4, 'succ_num': 4}, '100026': {'total_num': 0, 'succ_num': 0}, '100025': {'total_num': 0, 'succ_num': 0}, '100024': {'total_num': 0, 'succ_num': 0}, '100009': {'total_num': 0, 'succ_num': 0}, '100008': {'total_num': 125, 'succ_num': 74}, '100021': {'total_num': 0, 'succ_num': 0}, '100020': {'total_num': 0, 'succ_num': 0}}
Failed order count in mongoDB:10312
2016-10-26
2016-10-26:data processed,add province and serviceProvider
2016-10-26
2016-10-26:data grouped,by province and serviceProvider
Scaning data of 1 days ago,Date：2016-10-27
get 15 total data from hbase
{'totalCount': 15, 'succeed': 14, 'totalFlow': 1734}
get 1 failed data from hbase
{'100036': {'total_num': 0, 'succ_num': 0}, '100030': {'total_num': 0, 'succ_num': 0}, '100031': {'total_num': 0, 'succ_num': 0}, '100033': {'total_num': 0, 'succ_num': 0}, '100032': {'total_num': 0, 'succ_num': 0}, '100016': {'total_num': 0, 'succ_num': 0}, '100017': {'total_num': 0, 'succ_num': 0}, '100014': {'total_num': 1, 'succ_num': 1}, '100015': {'total_num': 0, 'succ_num': 0}, '100012': {'total_num': 0, 'succ_num': 0}, '100013': {'total_num': 0, 'succ_num': 0}, '100010': {'total_num': 0, 'succ_num': 0}, '100011': {'total_num': 5, 'succ_num': 5}, '100038': {'total_num': 0, 'succ_num': 0}, '100034': {'total_num': 0, 'succ_num': 0}, '100018': {'total_num': 2, 'succ_num': 2}, '100019': {'total_num': 0, 'succ_num': 0}, '100029': {'total_num': 1, 'succ_num': 1}, '100037': {'total_num': 0, 'succ_num': 0}, '100028': {'total_num': 0, 'succ_num': 0}, '100039': {'total_num': 0, 'succ_num': 0}, '100035': {'total_num': 0, 'succ_num': 0}, '100023': {'total_num': 0, 'succ_num': 0}, '100022': {'total_num': 0, 'succ_num': 0}, '100005': {'total_num': 0, 'succ_num': 0}, '100004': {'total_num': 0, 'succ_num': 0}, '100007': {'total_num': 0, 'succ_num': 0}, '100006': {'total_num': 0, 'succ_num': 0}, '100001': {'total_num': 3, 'succ_num': 2}, '100000': {'total_num': 0, 'succ_num': 0}, '100003': {'total_num': 1, 'succ_num': 1}, '100002': {'total_num': 1, 'succ_num': 1}, '100027': {'total_num': 1, 'succ_num': 1}, '100026': {'total_num': 0, 'succ_num': 0}, '100025': {'total_num': 0, 'succ_num': 0}, '100024': {'total_num': 0, 'succ_num': 0}, '100009': {'total_num': 0, 'succ_num': 0}, '100008': {'total_num': 0, 'succ_num': 0}, '100021': {'total_num': 0, 'succ_num': 0}, '100020': {'total_num': 0, 'succ_num': 0}}
Failed order count in mongoDB:0
2016-10-27
2016-10-27:data processed,add province and serviceProvider
2016-10-27
Traceback (most recent call last):
  File "crontabFailedAndGroup.py", line 20, in <module>
    schedule.run_pending()
  File "/home/work/.local/lib/python2.6/site-packages/schedule/__init__.py", line 367, in run_pending
    default_scheduler.run_pending()
  File "/home/work/.local/lib/python2.6/site-packages/schedule/__init__.py", line 64, in run_pending
    self._run_job(job)
  File "/home/work/.local/lib/python2.6/site-packages/schedule/__init__.py", line 96, in _run_job
    ret = job.run()
  File "/home/work/.local/lib/python2.6/site-packages/schedule/__init__.py", line 293, in run
    ret = self.job_func()
  File "crontabFailedAndGroup.py", line 10, in jobOrder
    saveOrderData(1,50000,True,True,True,True,True)
  File "/home/work/FEdevelop/security-orderstatisticpy/gen-py/__init__.py", line 100, in saveOrderData
    groupData(targetDateFormatted,targetDateFormatted,1,1)
  File "/home/work/FEdevelop/security-orderstatisticpy/gen-py/__init__.py", line 145, in groupData
    db.groupProvinceData.insert_many(groupProvince(listData))
  File "/home/work/.local/lib/python2.6/site-packages/pymongo/collection.py", line 670, in insert_many
    raise TypeError("documents must be a non-empty list")
TypeError: documents must be a non-empty list
